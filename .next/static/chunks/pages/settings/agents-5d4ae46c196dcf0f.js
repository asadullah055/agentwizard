(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{895:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var n=a(7876);function r(e){let{name:t,prompt:a,onClose:r}=e;return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"bg-white w-full max-w-lg p-6 rounded shadow relative",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:[t," – Prompt"]}),(0,n.jsx)("pre",{className:"bg-gray-100 p-3 rounded text-sm overflow-auto max-h-80",children:a}),(0,n.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,n.jsx)("button",{onClick:()=>navigator.clipboard.writeText(a),className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Copy"}),(0,n.jsx)("button",{onClick:r,className:"px-3 py-2 bg-gray-300 rounded",children:"Close"})]})]})})}var l=a(333),o=a(5364);let c="https://api.retellai.com",s="key_c64dab86009c916934d315eb28a6";async function i(e){let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!t.ok){let a=await t.text();throw Error("".concat(e," failed: ").concat(t.status," ").concat(a))}return t.json()}async function d(e){let t=await i("".concat(c,"/get-retell-llm/").concat(e));return t.prompt||t.general_prompt||t.system_prompt||t.llm&&(t.llm.prompt||t.llm.general_prompt)||""}let m={async startCall(e){let{agentExternalId:t,toPhoneE164:a,metadata:n}=e,r=await fetch("".concat(c,"/create-phone-call"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({agent_id:t,from_number:o.env.RETELL_PHONE_NUMBER,to_number:a,metadata:n})});if(!r.ok)throw Error("startCall failed: ".concat(r.status," ").concat(await r.text()));return{externalCallId:(await r.json()).call_id}},async stopCall(e){let t=await fetch("".concat(c,"/delete-call/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}});t.ok||console.error("Failed to stop call",await t.text())},async getAgentPrompt(e){var t;let a=await i("".concat(c,"/get-agent/").concat(e)),n=null==a||null==(t=a.response_engine)?void 0:t.llm_id;if(!n)return console.warn("⚠️ No LLM linked with this agent:",a),"";let r=await d(n);return r||console.warn("⚠️ Prompt empty for LLM:",n,"agent:",a),r},async importAgent(e){var t,a,n;let r=await i("".concat(c,"/get-agent/").concat(e)),l=null==r||null==(t=r.response_engine)?void 0:t.llm_id,o=l?await d(l):"";return{name:null!=(n=null!=(a=r.agent_name)?a:r.name)?n:e,prompt:o,config:r}}};var p=a(5364);let h="https://api.vapi.ai/v1",u={async startCall(e){let{agentExternalId:t,toPhoneE164:a,metadata:n}=e,r=await fetch("".concat(h,"/calls"),{method:"POST",headers:{Authorization:"Bearer ".concat(p.env.VAPI_API_KEY),"Content-Type":"application/json"},body:JSON.stringify({agent_id:t,to:a,metadata:n})});if(!r.ok)throw Error("VAPI startCall failed: ".concat(r.statusText));return{externalCallId:(await r.json()).id}},async stopCall(e){await fetch("".concat(h,"/calls/").concat(e,"/stop"),{method:"POST",headers:{Authorization:"Bearer ".concat(p.env.VAPI_API_KEY)}})},async getAgentPrompt(e){var t;let a=await fetch("".concat(h,"/agents/").concat(e),{headers:{Authorization:"Bearer ".concat(p.env.VAPI_API_KEY)}});return null!=(t=(await a.json()).prompt)?t:""},async importAgent(e){let t=await fetch("".concat(h,"/agents/").concat(e),{headers:{Authorization:"Bearer ".concat(p.env.VAPI_API_KEY)}}),a=await t.json();return{name:a.name,prompt:a.prompt,config:a}}};var x=a(4256),g=a(4232);let f=(0,x.UU)("https://oocueuyucxahfeyijikr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9vY3VldXl1Y3hhaGZleWlqaWtyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA4OTI2NTgsImV4cCI6MjA3NjQ2ODY1OH0.tWAzcnjSi-RoN3Tca8UjSqLKgkMT3NwBOyv46btg-6I");function b(){var e;let[t,a]=(0,g.useState)([]),[o,c]=(0,g.useState)(null);async function s(){let{data:e}=await f.from("agents").select("*").order("created_at",{ascending:!1});a(null!=e?e:[])}async function i(e){let t=prompt("Enter external agent ID");if(!t)return;let a=function(e){switch(e){case"retell":return m;case"vapi":return u;default:throw Error("Unsupported provider: ".concat(e))}}(e),n=await a.importAgent(t);await f.from("agents").insert({name:n.name,provider:e,mode:"outbound",external_agent_id:t,prompt_text:n.prompt,config_json:n.config}),await s()}return(0,g.useEffect)(()=>{s()},[]),(0,n.jsx)(l.A,{children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Agents Settings"}),(0,n.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,n.jsx)("button",{onClick:()=>i("retell"),className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Import from Re:Tell"}),(0,n.jsx)("button",{onClick:()=>i("vapi"),className:"px-4 py-2 bg-green-600 text-white rounded",children:"Import from VAPI"})]}),(0,n.jsxs)("table",{className:"min-w-full border",children:[(0,n.jsx)("thead",{className:"bg-gray-100",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"p-2 border",children:"Name"}),(0,n.jsx)("th",{className:"p-2 border",children:"Provider"}),(0,n.jsx)("th",{className:"p-2 border",children:"Mode"}),(0,n.jsx)("th",{className:"p-2 border",children:"Active"}),(0,n.jsx)("th",{className:"p-2 border",children:"Prompt"})]})}),(0,n.jsx)("tbody",{children:t.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"border p-2",children:e.name}),(0,n.jsx)("td",{className:"border p-2",children:e.provider}),(0,n.jsx)("td",{className:"border p-2",children:e.mode}),(0,n.jsx)("td",{className:"border p-2",children:e.is_active?"✅":"❌"}),(0,n.jsx)("td",{className:"border p-2",children:(0,n.jsx)("button",{className:"text-blue-600 underline",onClick:()=>c(e),children:"View"})})]},e.id))})]}),o&&(0,n.jsx)(r,{name:o.name,prompt:null!=(e=o.prompt_text)?e:"",onClose:()=>c(null)})]})})}},2004:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/agents",function(){return a(895)}])}},e=>{e.O(0,[367,256,333,636,593,792],()=>e(e.s=2004)),_N_E=e.O()}]);